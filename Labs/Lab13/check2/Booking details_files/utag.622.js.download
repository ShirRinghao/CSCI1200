//tealium universal tag - utag.622 ut4.0.201810240728, Copyright 2018 Tealium.com Inc. All Rights Reserved.
window.Krux||((Krux=function(){Krux.q.push(arguments)}).q=[]);try{(function(id,loader){var u={"id":id};utag.o[loader].sender[id]=u;if(utag.ut===undefined){utag.ut={};}
u.ev={"view":1};u.map={"offer.promotion_code":"custom.offer_promotion code","offer.promotion_type":"custom.offer_promotion type","transaction.coupon.type":"custom.offer_coupon type","transaction.coupon.name":"custom.offer_coupon name","transaction.coupon.code":"custom.offer_coupon code","page.country":"custom.page_country","page.language":"custom.page_language","page.login_status":"custom.page_login status","page.brand":"custom.page_brand","registration.age_group":"custom.member_age","registration.asia_miles":"custom.member_asia miles","registration.club_miles":"custom.member_club miles","registration.club_points":"custom.member_club point","registration.club_sectors":"custom.member_club sector","registration.member_since":"custom.member_registration date","registration.membership_years":"custom.member_year","registration.type":"custom.member_type","campaign.utm_campaign":"custom.traffic_incoming campaign","campaign.utm_content":"custom.traffic_incoming content","campaign.utm_medium":"custom.traffic_incoming medium","campaign.utm_source":"custom.traffic_incoming source","campaign.utm_term":"custom.traffic_incoming term","application.name":"custom.application_name","collection.products.ff_codes":"custom.product_fare family code","collection.products.ff_names":"custom.product_fare family name","collection.products.product_ids":"custom.product_name","collection.products.prices":"custom.product_price","collection.products.qtys":"custom.product_quantity","collection.products.subtotals":"custom.product_subtotal","collection.products.types":"custom.product_type","itinerary.destination.airport":"custom.flight_destination (airport)","itinerary.destination.city":"custom.flight_destination (city)","itinerary.destination.country":"custom.flight_destination (country)","itinerary.inbound.date":"custom.flight_inbound_date","itinerary.inbound.month":"custom.flight_inbound_month","itinerary.inbound.datetime":"custom.flight_inbound_time","itinerary.inbound.year":"custom.flight_inbound_year","itinerary.origin.airport":"custom.flight_origin (airport)","itinerary.origin.city":"custom.flight_origin (city)","itinerary.origin.country":"custom.flight_origin (country)","itinerary.outbound.date":"custom.flight_outbound_date","itinerary.outbound.month":"custom.flight_outbound_month","itinerary.outbound.datetime":"custom.flight_outbound_time","itinerary.outbound.year":"custom.flight_outbound_year","itinerary.pax.adult":"custom.flight_pax_no of adults","itinerary.pax.child":"custom.flight_pax_no of child","itinerary.pax.combination":"custom.flight_pax_combination","itinerary.pax.infant":"custom.flight_pax_no of infant","itinerary.pax.total":"custom.flight_pax_total no","itinerary.segmented_carriers":"custom.flight_segmented carrier","itinerary.trip_type":"custom.flight_trip type","search.destination.airport":"custom.search_flight_destination (airport),custom.search_package_return (airport)","search.origin.airport":"custom.search_flight_origin (airport)","search.origin.city":"custom.search_flight_origin (city)","search.origin.country":"custom.search_flight_origin (country),custom.search_package_return (country)","search.params.cabin":"custom.search_flight_cabin","search.params.date_inbound":"custom.search_flight_return date","search.params.date_outbound":"custom.search_flight_departure date","search.params.days_advance":"custom.search_hotel_days in advance","search.params.destination.airport":"custom.search_flight_destination (airport)","search.params.destination.city":"custom.search_flight_destination (city)","search.params.destination.country":"custom.search_flight_destination (country)","search.params.origin.airport":"custom.search_flight_origin (airport)","search.params.origin.city":"custom.search_flight_origin (city)","search.params.origin.country":"custom.search_flight_origin (country)","search.params.pax.adult":"custom.search_pax_no of adults","search.params.pax.child":"custom.search_pax_no of child","search.params.pax.combination":"custom.search_pax_combination","search.params.pax.infant":"custom.search_pax_no of infant","search.params.pax.total":"custom.search_pax_total no","search.params.trip_type":"custom.search_flight_trip type","search.type":"custom.search_product_type","search.destination.city":"custom.search_flight_destination (city),custom.search_package_return (city)","search.destination.country":"custom.search_flight_destination (country),custom.search_package_return (country)","booking.booking_id":"custom.booking_booking id","booking.days_advance":"custom.booking_days before departure","booking.route":"custom.booking_flight_route (o+d)","booking.status":"custom.booking_status","booking.type":"custom.booking_type","custom_data.ibe.office_id":"custom.custom_office_id","itinerary.cabin":"custom.flight_cabin","itinerary.days_advance":"custom.flight_days before departure","itinerary.flight_duration":"custom.flight_flight duration","itinerary.route":"custom.flight_route (o+d)","itinerary.segment_count":"custom.flight_segmented flight count","itinerary.segmented_flights":"custom.flight_segmented flights","itinerary.trip_duration":"custom.flight_trip duration","stay.guest":"custom.hotel_ pax_total no","stay.guest_combination":"custom.hotel_ pax_combination","stay.total_hotel_nights":"custom.hotel_no of nights","stay.total_hotels":"custom.hotel_no of hotels","transaction.currency":"custom.transaction_currency","transaction.currency_fxmp":"custom.transaction_original currency","transaction.total":"custom.transaction_total (local currency)","transaction.total_in_HKD":"custom.transaction_total (hkd)","custom_data.ibe.upsell_category":"custom.ribe_upsell item_category","custom_data.ibe.upsell_value":"custom.ribe_upsell item_value difference","page.currency":"custom.page_currency","booking.booked_from":"custom.booking_booking channel","custom_data.ibe.upsell_currency":"custom.upsell_currency","custom_data.ibe.upsell_indicator":"custom.upsell_indicator","custom_data.ibe.upsell_item_from":"custom.upsell_item_from","custom_data.ibe.upsell_item_to":"custom.upsell_item_to","itinerary.days_after_booking":"custom.days_after_booking","itinerary.is_next_flight":"custom.is_next_flight","search.hotel_destination.city":"custom.search_hotel_destination_city","search.hotel_destination.country":"custom.search_hotel_destination_country","booking.days_after_booking":"custom.days_after_booking","booking.total_bookings":"custom.total_bookings","booking.latest_booking":"custom.latest_booking","booking.office_id":"custom.booking_office_id","collection.products.currencies":"custom.product_currency","collection.products.pax_type":"custom.product_pax_type","search.params.date_checkin":"custom.search_hotel_departure_date","search.params.date_checkout":"custom.search_hotel_return_date","search.params.night":"custom.search_hotel_no_of_nights","search.params.room":"custom.search_hotel_no_of_rooms","search.params.room_pax":"custom.search_hotel_pax_combination","stay.hotels.hotel_id":"custom.hotel_hotel_id","stay.hotels.hotel_brand":"custom.hotel_hotel_brand","stay.hotels.hotel_name":"custom.hotel_hotel_name","stay.hotels.rooms":"custom.hotel_no_of_rooms","stay.hotels.city":"custom.hotel_destination_city","stay.hotels.country":"custom.hotel_destination_country","stay.hotels.room_type":"custom.hotel_room_type","stay.hotels.bed_type":"custom.hotel_bed_type","stay.hotels.extras":"custom.hotel_extras","stay.hotels.refundable":"custom.hotel_refundable","search.pax.child_age":"custom.search_pax_child_age","registration.email":"custom.email_sha256","search.pax.total":"custom.search_pax_total_no","search.pax.adult":"custom.search_pax_no_of_adults","search.pax.child":"custom.search_pax_no_of_child","search.pax.infant":"custom.search_pax_no_of_infant","search.pax.combination":"custom.search_pax_combination","va.properties.27328":"custom.subid","registration.registration_id":"custom.membership_no","booking.pax.adult":"custom.mmb_pax_no_of_adult","booking.pax.child":"custom.mmb_pax_no_of_child","booking.pax.combination":"custom.mmb_pax_combination","booking.pax.infant":"custom.mmb_pax_no_of_infant","booking.pax.total":"custom.mmb_pax_total_no","vendor.ga.page_id":"custom.page_name"};u.extend=[function(a,b){try{if(b['application.name']!='TRP'){try{b['vendor.ga.page_id']=(function(p){return p.toUpperCase().replace(/::/g,"/")})(b["page.page_id"])}catch(e){}}}catch(e){utag.DB(e)}},function(a,b){utag.ut.sha256=function(h,s){var f={},t=f.lib={},g=function(){},j=t.Base={extend:function(a){g.prototype=this;var c=new g;a&&c.mixIn(a);c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)});c.init.prototype=c;c.$super=this;return c},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},q=t.WordArray=j.extend({init:function(a,c){a=this.words=a||[];this.sigBytes=c!=s?c:4*a.length},toString:function(a){return(a||u).stringify(this)},concat:function(a){var c=this.words,d=a.words,b=this.sigBytes;a=a.sigBytes;this.clamp();if(b%4)for(var e=0;e<a;e++)c[b+e>>>2]|=(d[e>>>2]>>>24-8*(e%4)&255)<<24-8*((b+e)%4);else if(65535<d.length)for(e=0;e<a;e+=4)c[b+e>>>2]=d[e>>>2];else c.push.apply(c,d);this.sigBytes+=a;return this},clamp:function(){var a=this.words,c=this.sigBytes;a[c>>>2]&=4294967295<<32-8*(c%4);a.length=h.ceil(c/4)},clone:function(){var a=j.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var c=[],d=0;d<a;d+=4)c.push(4294967296*h.random()|0);return new q.init(c,a)}}),v=f.enc={},u=v.Hex={stringify:function(a){var c=a.words;a=a.sigBytes;for(var d=[],b=0;b<a;b++){var e=c[b>>>2]>>>24-8*(b%4)&255;d.push((e>>>4).toString(16));d.push((e&15).toString(16))}return d.join("")},parse:function(a){for(var c=a.length,d=[],b=0;b<c;b+=2)d[b>>>3]|=parseInt(a.substr(b,2),16)<<24-4*(b%8);return new q.init(d,c/2)}},k=v.Latin1={stringify:function(a){var c=a.words;a=a.sigBytes;for(var d=[],b=0;b<a;b++)d.push(String.fromCharCode(c[b>>>2]>>>24-8*(b%4)&255));return d.join("")},parse:function(a){for(var c=a.length,d=[],b=0;b<c;b++)d[b>>>2]|=(a.charCodeAt(b)&255)<<24-8*(b%4);return new q.init(d,c)}},l=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(k.stringify(a)))}catch(c){throw Error("Malformed UTF-8 data");}},parse:function(a){return k.parse(unescape(encodeURIComponent(a)))}},x=t.BufferedBlockAlgorithm=j.extend({reset:function(){this._data=new q.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=l.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var c=this._data,d=c.words,b=c.sigBytes,e=this.blockSize,f=b/(4*e),f=a?h.ceil(f):h.max((f|0)-this._minBufferSize,0);a=f*e;b=h.min(4*a,b);if(a){for(var m=0;m<a;m+=e)this._doProcessBlock(d,m);m=d.splice(0,a);c.sigBytes-=b}return new q.init(m,b)},clone:function(){var a=j.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});t.Hasher=x.extend({cfg:j.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){x.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(c,d){return(new a.init(d)).finalize(c)}},_createHmacHelper:function(a){return function(c,d){return(new w.HMAC.init(a,d)).finalize(c)}}});var w=f.algo={};return f}(Math);(function(h){for(var s=utag.ut.sha256,f=s.lib,t=f.WordArray,g=f.Hasher,f=s.algo,j=[],q=[],v=function(a){return 4294967296*(a-(a|0))|0},u=2,k=0;64>k;){var l;a:{l=u;for(var x=h.sqrt(l),w=2;w<=x;w++)if(!(l%w)){l=!1;break a}l=!0}l&&(8>k&&(j[k]=v(h.pow(u,0.5))),q[k]=v(h.pow(u,1/3)),k++);u++}var a=[],f=f.SHA256=g.extend({_doReset:function(){this._hash=new t.init(j.slice(0))},_doProcessBlock:function(c,d){for(var b=this._hash.words,e=b[0],f=b[1],m=b[2],h=b[3],p=b[4],j=b[5],k=b[6],l=b[7],n=0;64>n;n++){if(16>n)a[n]=c[d+n]|0;else{var r=a[n-15],g=a[n-2];a[n]=((r<<25|r>>>7)^(r<<14|r>>>18)^r>>>3)+a[n-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+a[n-16]}r=l+((p<<26|p>>>6)^(p<<21|p>>>11)^(p<<7|p>>>25))+(p&j^~p&k)+q[n]+a[n];g=((e<<30|e>>>2)^(e<<19|e>>>13)^(e<<10|e>>>22))+(e&f^e&m^f&m);l=k;k=j;j=p;p=h+r|0;h=m;m=f;f=e;e=r+g|0}b[0]=b[0]+e|0;b[1]=b[1]+f|0;b[2]=b[2]+m|0;b[3]=b[3]+h|0;b[4]=b[4]+p|0;b[5]=b[5]+j|0;b[6]=b[6]+k|0;b[7]=b[7]+l|0},_doFinalize:function(){var a=this._data,d=a.words,b=8*this._nDataBytes,e=8*a.sigBytes;d[e>>>5]|=128<<24-e%32;d[(e+64>>>9<<4)+14]=h.floor(b/4294967296);d[(e+64>>>9<<4)+15]=b;a.sigBytes=4*d.length;this._process();return this._hash},clone:function(){var a=g.clone.call(this);a._hash=this._hash.clone();return a}});s.SHA256=g._createHelper(f);s.HmacSHA256=g._createHmacHelper(f)})(Math);try{if(typeof b['registration.email']!='undefined'&&b['registration.email']!=''){b['registration.email']=utag.ut.sha256.SHA256(b['registration.email']).toString();}}catch(e){}}];u.send=function(a,b){if(u.ev[a]||u.ev.all!==undefined){utag.DB("send:622");utag.DB(b);var c,d,e,f;u.data={"confid":"srec3rek3","custom":{},};for(c=0;c<u.extend.length;c++){try{d=u.extend[c](a,b);if(d==false)return}catch(e){}};utag.DB("send:622:EXTENSIONS");utag.DB(b);for(d in utag.loader.GV(u.map)){if(b[d]!==undefined&&b[d]!==""){e=u.map[d].split(",");for(f=0;f<e.length;f++){if(e[f].indexOf("custom.")===0){var id=e[f].substr(7);u.data.custom[id]=b[d];}
else
u.data[e[f]]=b[d];}}}
utag.DB("send:622:MAPPINGS");utag.DB(u.data);if(!u.data.confid){utag.DB(u.id+": Tag not fired: Required attribute not populated");return;}
if(typeof window.Krux.ns!=="object"){(function(){var k=document.createElement('script');k.type='text/javascript';k.async=true;k.src=(location.protocol==="https:"?"https:":"http:")+"//cdn.krxd.net/controltag/"+u.data.confid+".js";var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(k,s);}());}
Krux('ns:cathaypacific','track:all',u.data.custom);utag.DB("send:622:COMPLETE");}};utag.o[loader].loader.LOAD(id);}("622","cx.web"));}catch(error){utag.DB(error);}
